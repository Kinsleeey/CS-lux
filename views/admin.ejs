<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CS-Luxury</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap" rel="stylesheet"/>
    <link
  href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap"
  rel="stylesheet"
/>

</head>
<body>
    <header>
        
        <div class="main-header flex-sb-c">
            <div class="brand flex-sb-c gap05">
                <div class="brand-img"></div>
                <p>CS Luxury</p>
            </div>
            <nav>
                <ul class="nav flex-sb-c gap1">
                    <li><a href="/admin">Home</a></li>
                    <li><a href="/product">Product</a></li>
                    <li><a href="/cart">Cart</a></li>
                </ul>
            </nav>
            <div class="whiteback" id="user-profile">
                <svg xmlns="http://www.w3.org/2000/svg" width="22" height="32" fill="#000000" viewBox="0 0 256 256"><path d="M230.92,212c-15.23-26.33-38.7-45.21-66.09-54.16a72,72,0,1,0-73.66,0C63.78,166.78,40.31,185.66,25.08,212a8,8,0,1,0,13.85,8c18.84-32.56,52.14-52,89.07-52s70.23,19.44,89.07,52a8,8,0,1,0,13.85-8ZM72,96a56,56,0,1,1,56,56A56.06,56.06,0,0,1,72,96Z"></path></svg>
            </div>
        </div>
    </header>
    <div class="admin-landing">
        <h1>Welcome Admin</h1>
        <div class="input-category">
            <h4 style="text-align: center;">Create Category</h4>
            <p>Categories Available</p>
            <ul>
            <% categories.forEach(c => { %>
                <li><%= c.name %></li>
            <% }) %>
            </ul>
            <form action="/new-category" method="post">
                <input type="text" name="category" placeholder="create new category"/>
                <button type="submit">Add</button>
            </form>
            <% if (msg) { %>
                <p class="alert"><%= msg %></p>
            <% } %>
        </div>


        <div class="input-product">
            <form action="/upload" method="post" enctype="multipart/form-data">
                <h4 style="text-align: center;">Create New Product</h4>

                <div class="flex-c gap1">
                    <p>Product Category</p>
                    <select name="category-id">
                        <option value="">Select an option</option>
                        <% categories.forEach(c => { %>
                            <option value="<%= c.id %>"><%= c.name %></option>
                        <% }) %>
                    </select>
                </div>

                <div><label>Product Name <input type="text" name="product-name" /></label></div>
                <div><label>Product Description <input type="text" name="product-des" /></label></div>
                <div id="container" style="border: 1px solid rgb(219, 219, 219);">
                    <div class="flex-sb-c">
                        <p>Size:(optional)</p>
                        <div style="border: 1px solid; width: fit-content; font-size: 12px;" onclick="addRow()">Add +</div> 
                    </div>
                    <div id="rows"></div>                    
                </div>
                
                <div><label>Product Price <input type="number" name="product-price" /></label></div>
                <div id="single-stock" class="single-stock"><label>Quantity in Stock<input type="number" name="single-stock" /></label></div>
                <div class="single-p-pic">
                    <label>Upload Product Image<input type="file" name="product-img" accept="image/*" onchange="previewImage(this)" /></label>
                    <img id="image-preview" src="" alt="Image Preview" style="display:none; margin-top:10px; max-width:200px; max-height:200px; object-fit:cover;" />
                </div>

                <div><button style="padding: 0.7rem 1rem ; margin: 0 auto;" type="submit">Add to Website</button></div>
            </form>
        </div>
        
    </div>
    <script>
        
        function updateSingleStock() {
            const hasRows = document.querySelectorAll('.row').length > 0;
            document.getElementById('single-stock').style.display = hasRows ? 'none' : '';
        }

        function removeRow(btn) {
            btn.parentElement.remove();
            updateSingleStock();
        }

        function addRow() {
            const div = document.createElement('div');
            div.className = 'row';
            div.innerHTML = `
                <div class="flex-sb-c">
                    <input type="text" name="sizes[]" placeholder="Size" required>
                    <input type="number" name="stock[]" placeholder="Stock" required>
                    <div onclick="removeRow(this)">x</div>
                </div>
                `;
            document.getElementById('rows').appendChild(div);
            updateSingleStock();
        }

        function previewImage(input) {
            const preview = document.getElementById('image-preview');
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    preview.src = e.target.result;
                    preview.style.display = 'block';
                };
                reader.readAsDataURL(input.files[0]);
            } else {
                preview.src = '';
                preview.style.display = 'none';
            }
        }
    </script>

</body>
</html>